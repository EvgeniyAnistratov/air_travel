# Air Travel
FastAPI приложение, имитирующие работу с авиаперелетами. Реализует REST API
для работы с рейсами, авиакомпаниями, перелетами и пассажирами.

Стек технологий:
 - FastAPI
 - SQLAlchemy
 - PostgreSQL


## Переменные окружения
Список ожидаемых переменных окружения, используемых приложением, описан в
файле .env.example. Переменные окружения могут быть настроены в файле .env,
для этого нужно скопировать файл .env.example под именем .env и настроить
переменные окружения в этом файле:

```bash
cp .env.example .env
```

Также переменные окружения можно настроить без создания файла ___.env___ в
корневой директории проекта. Для этого все переменные окружения можно
настроить как __переменные окружения__ или __переменные оболочки__. Например,
с помощью команды ___export___ (встроенной утилиты оболочки Linux Bash:
___export ENV_NAME=ENV_VALUE___), или другим доступным способом.<br />

### Описание перменных окружения
#### APP_PORT
По умолчанию: __8000__ <br/>
Порт, который будет прослушиваться сервисом

#### DB_HOST
По умолчанию: __postgres__ <br />
Хост БД. Если приложение будет запускаться в docker контейнере, и БД тоже
будет запущена в docker контейнере, то значение хоста должно хранить имя
сервиса БД, описанного в docker-compose файле.

#### DB_NAME
По умолчанию: __air_travel_db__ <br />
Имя БД.

#### DB_PASSWORD
По умолчанию: __<не определена>__ <br />
Пароль пользователя БД.

#### DB_PORT
По умолчанию: __5432__ <br />
Порт БД.

#### DB_USER
По умолчанию: __postgres__ <br />
Имя роли для подключения к БД.


## Запуск приложения через docker compose
1. Выполнить настройку переменных окружения (см. раздел [Переменные окружения](#переменные-окружения)).
   Убедиться, что переменная DB_HOST хранит имя сервиса, описанного в docker-compose.yaml
    - DB_HOST=postgres
2. Запустить приложение в контейнере
```bash
docker-compose --env-file .env up
```


## Запуск приложения без docker
Ниже описаны шаги для запуска микросервиса. Подразумевается, что PostgreSQL
уже установлен или запущен в docker контейнере.

В проекте используется менеджер пакетов и зависимостей
[poetry](https://python-poetry.org/).

Минимальная версия python: 3.13

1. Создание виртуального окружения python
```bash
python3 -m venv .venv
```
2. Активация виртуального окружения
```bash
source .venv/bin/activate
```
3. Обновление __pip__
```bash
python3 -m pip install --upgrade pip
```
4. Установка __poetry__
```bash
pip install poetry
```
5. Может потребоваться обновить __poetry.lock__ файл
```bash
poetry lock
```
6. Установка пакетов и зависимостей
```bash
poetry install --no-root
```
7. Создание файла переменных окружения (подробно см. ["Переменные окружения"](#переменные-окружения))
```bash
cp .env.example .env
```
8. Запуск локального сервера
```bash
uvicorn main:app
```
